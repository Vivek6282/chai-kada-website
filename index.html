<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>‡¥ú‡µã‡¥∏‡µá‡¥ü‡µç‡¥ü‡¥®‡µç‡¥±‡µÜ
        ‡¥ö‡¥æ‡¥Ø‡¥ï‡µç‡¥ï‡¥ü</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <header>
        <a href="intro.html" class="back-btn">Home Page</a>

        <div class="language-switcher">
            <button onclick="changeLanguage('en')">üá¨üáß EN</button>
            <button onclick="changeLanguage('ml')">üáÆüá≥ ML</button>
            <button onclick="changeLanguage('hi')">üáÆüá≥ HI</button>
        </div>

        <h1 id="main-title">üçõ ‡¥ú‡µã‡¥∏‡µá‡¥ü‡µç‡¥ü‡¥®‡µç‡¥±‡µÜ ‡¥ö‡¥æ‡¥Ø‡¥ï‡µç‡¥ï‡¥ü üçõ</h1>
        <p id="main-subtitle">Authentic Kerala Street Snacks</p>
    </header>

    <section class="menu">
        <h2 id="menu-title">Our Menu</h2>
        <div class="menu-container">

            <div class="item"
                style="background-image: linear-gradient(rgba(0,0,0,0.0), rgba(0,0,0,0.0)), url('images/Uzhunnuvada.jpg');">
                <h3 id="name-Uzhunnu-Vada">‡¥â‡¥¥‡µÅ‡¥®‡µç‡¥®‡µç ‡¥µ‡¥ü</h3>
                <p>‚Çπ25</p>
                <div class="quantity-controls">
                    <button onclick="changeQuantity('Uzhunnu Vada', 25, -1)">-</button>
                    <span id="qty-Uzhunnu-Vada">0</span>
                    <button onclick="changeQuantity('Uzhunnu Vada', 25, 1)">+</button>
                </div>
            </div>

            <div class="item"
                style="background-image: linear-gradient(rgba(0,0,0,0.0), rgba(0,0,0,0.0)), url('images/banana.jpg');">
                <h3 id="name-Pazham-Pori">‡¥™‡¥¥‡¥Ç‡¥™‡µä‡¥∞‡¥ø</h3>
                <p>‚Çπ30</p>
                <div class="quantity-controls">
                    <button onclick="changeQuantity('Pazham Pori', 30, -1)">-</button>
                    <span id="qty-Pazham-Pori">0</span>
                    <button onclick="changeQuantity('Pazham Pori', 30, 1)">+</button>
                </div>
            </div>

            <div class="item"
                style="background-image: linear-gradient(rgba(0,0,0,0.0), rgba(0,0,0,0.0)), url('images/Parippuvada.jpg');">
                <h3 id="name-Parippu-Vada">‡¥™‡¥∞‡¥ø‡¥™‡µç‡¥™‡µç ‡¥µ‡¥ü</h3>
                <p>‚Çπ20</p>
                <div class="quantity-controls">
                    <button onclick="changeQuantity('Parippu Vada', 20, -1)">-</button>
                    <span id="qty-Parippu-Vada">0</span>
                    <button onclick="changeQuantity('Parippu Vada', 20, 1)">+</button>
                </div>
            </div>

            <div class="item"
                style="background-image: linear-gradient(rgba(0,0,0,0.0), rgba(0,0,0,0.0)), url('images/Sukhiyan.jpg');">
                <h3 id="name-Sukhiyan">‡¥∏‡µÅ‡¥ñ‡¥ø‡¥Ø‡µª</h3>
                <p>‚Çπ20</p>
                <div class="quantity-controls">
                    <button onclick="changeQuantity('Sukhiyan', 20, -1)">-</button>
                    <span id="qty-Sukhiyan">0</span>
                    <button onclick="changeQuantity('Sukhiyan', 20, 1)">+</button>
                </div>
            </div>

            <div class="item"
                style="background-image: linear-gradient(rgba(0,0,0,0.0), rgba(0,0,0,0.0)), url('images/Kappabajji.jpg');">
                <h3 id="name-Kappa-Bajji">‡¥ï‡¥™‡µç‡¥™ ‡¥¨‡¥ú‡µç‡¥ú‡¥ø</h3>
                <p>‚Çπ40</p>
                <div class="quantity-controls">
                    <button onclick="changeQuantity('Kappa Bajji', 40, -1)">-</button>
                    <span id="qty-Kappa-Bajji">0</span>
                    <button onclick="changeQuantity('Kappa Bajji', 40, 1)">+</button>
                </div>
            </div>

            <div class="item"
                style="background-image: linear-gradient(rgba(0,0,0,0.0), rgba(0,0,0,0.0)), url(images/eggbond.jpg);">
                <h3 id="name-Egg-Bonda">‡¥é‡¥ó‡µç ‡¥¨‡µã‡¥£‡µç‡¥ü‡µç</h3>
                <p>‚Çπ35</p>
                <div class="quantity-controls">
                    <button onclick="changeQuantity('Egg Bonda', 35, -1)">-</button>
                    <span id="qty-Egg-Bonda">0</span>
                    <button onclick="changeQuantity('Egg Bonda', 35, 1)">+</button>
                </div>
            </div>

            <div class="item"
                style="background-image: linear-gradient(rgba(0,0,0,0.0), rgba(0,0,0,0.0)), url('images/Tea.jpg');">
                <h3 id="name-Tea">‡¥ö‡¥æ‡¥Ø</h3>
                <p>‚Çπ15</p>
                <div class="quantity-controls">
                    <button onclick="changeQuantity('Tea', 15, -1)">-</button>
                    <span id="qty-Tea">0</span>
                    <button onclick="changeQuantity('Tea', 15, 1)">+</button>
                </div>
            </div>

            <div class="item"
                style="background-image: linear-gradient(rgba(0,0,0,0.0), rgba(0,0,0,0.0)), url('images/Coffee .jpg');">
                <h3 id="name-Coffee">‡¥ï‡¥æ‡¥™‡µç‡¥™‡¥ø</h3>
                <p>‚Çπ20</p>
                <div class="quantity-controls">
                    <button onclick="changeQuantity('Coffee', 20, -1)">-</button>
                    <span id="qty-Coffee">0</span>
                    <button onclick="changeQuantity('Coffee', 20, 1)">+</button>
                </div>
            </div>

            <div class="item"
                style="background-image: linear-gradient(rgba(0,0,0,0.0), rgba(0,0,0,0.0)), url('images/Kallumkkaya.jpg');">
                <h3 id="name-Kallummakkaya">‡¥ï‡¥≤‡µç‡¥≤‡µÅ‡¥Æ‡µç‡¥Æ‡¥ï‡µç‡¥ï‡¥æ‡¥Ø</h3>
                <p>‚Çπ100</p>
                <div class="quantity-controls">
                    <button onclick="changeQuantity('Kallummakkaya', 100, -1)">-</button>
                    <span id="qty-Kallummakkaya">0</span>
                    <button onclick="changeQuantity('Kallummakkaya', 100, 1)">+</button>
                </div>
            </div>

        </div>



    </section>

    <div class="floating-cart" onclick="toggleCart()">
        üõí
        <span id="cart-badge">0</span>
    </div>

    <div id="cart-modal" class="cart-modal">
        <div class="cart-modal-content">
            <span class="close-btn" onclick="toggleCart()">&times;</span>

            <h2 id="cart-title">üõí Your Bill</h2>
            <ul id="cart-items"></ul>
            <h3><span id="total-label">Total</span>: ‚Çπ<span id="total">0</span></h3>

            <div class="cart-actions">
                <button id="clear-btn" onclick="clearCart()" style="background: #757575;">Clear All</button>
                <button id="pay-btn" onclick="placeOrder()">Pay Bill</button>
            </div>
            <p id="confirmation"></p>
        </div>
    </div>

    <script>
        console.log('Script loaded');
        let cart = [];
        let total = 0;
        let currentLang = 'ml'; // Default to Malayalam

        const translations = {
            en: {
                mainTitle: "üçõ Josettante Chai Kada üçõ",
                mainSubtitle: "Authentic Kerala Street Snacks",
                menuTitle: "Our Menu",
                cartTitle: "üõí Your Bill",
                totalLabel: "Total",
                clearBtn: "Clear All",
                payBtn: "Pay Bill",
                removeBtn: "Remove",
                emptyCart: "Your cart is empty!",
                orderPlaced: "‚úÖ Order placed! Thank you ‚Äî come again",
                items: {
                    "Uzhunnu Vada": "Uzhunnu Vada",
                    "Pazham Pori": "Pazham Pori",
                    "Parippu Vada": "Parippu Vada",
                    "Sukhiyan": "Sukhiyan",
                    "Kappa Bajji": "Kappa Bajji",
                    "Egg Bonda": "Egg Bonda",
                    "Tea": "Tea",
                    "Coffee": "Coffee",
                    "Kallummakkaya": "Kallummakkaya"
                }
            },
            ml: {
                mainTitle: "üçõ ‡¥ú‡µã‡¥∏‡µá‡¥ü‡µç‡¥ü‡¥®‡µç‡¥±‡µÜ ‡¥ö‡¥æ‡¥Ø‡¥ï‡µç‡¥ï‡¥ü üçõ",
                mainSubtitle: "‡¥®‡¥≤‡µç‡¥≤ ‡¥§‡¥®‡¥ø ‡¥®‡¥æ‡¥ü‡µª ‡¥™‡¥≤‡¥π‡¥æ‡¥∞‡¥ô‡µç‡¥ô‡µæ",
                menuTitle: "‡¥û‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥µ‡¥ø‡¥≠‡¥µ‡¥ô‡µç‡¥ô‡µæ",
                cartTitle: "üõí ‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥¨‡¥ø‡¥≤‡µç‡¥≤‡µç",
                totalLabel: "‡¥Ü‡¥ï‡µÜ",
                clearBtn: "‡¥é‡¥≤‡µç‡¥≤‡¥æ‡¥Ç ‡¥í‡¥¥‡¥ø‡¥µ‡¥æ‡¥ï‡µç‡¥ï‡µÅ‡¥ï",
                payBtn: "‡¥™‡¥£‡¥Æ‡¥ü‡¥Ø‡µç‡¥ï‡µç‡¥ï‡µÅ‡¥ï",
                removeBtn: "‡¥Æ‡¥æ‡¥±‡µç‡¥±‡µÅ‡¥ï",
                emptyCart: "‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥ï‡¥æ‡µº‡¥ü‡µç‡¥ü‡µç ‡¥∂‡µÇ‡¥®‡µç‡¥Ø‡¥Æ‡¥æ‡¥£‡µç!",
                orderPlaced: "‚úÖ ‡¥ì‡µº‡¥°‡µº ‡¥®‡µΩ‡¥ï‡¥ø! ‡¥®‡¥®‡µç‡¥¶‡¥ø ‚Äî ‡¥µ‡µÄ‡¥£‡µç‡¥ü‡µÅ‡¥Ç ‡¥µ‡¥∞‡¥ø‡¥ï",
                items: {
                    "Uzhunnu Vada": "‡¥â‡¥¥‡µÅ‡¥®‡µç‡¥®‡µç ‡¥µ‡¥ü",
                    "Pazham Pori": "‡¥™‡¥¥‡¥Ç‡¥™‡µä‡¥∞‡¥ø",
                    "Parippu Vada": "‡¥™‡¥∞‡¥ø‡¥™‡µç‡¥™‡µç ‡¥µ‡¥ü",
                    "Sukhiyan": "‡¥∏‡µÅ‡¥ñ‡¥ø‡¥Ø‡µª",
                    "Kappa Bajji": "‡¥ï‡¥™‡µç‡¥™ ‡¥¨‡¥ú‡µç‡¥ú‡¥ø",
                    "Egg Bonda": "‡¥é‡¥ó‡µç ‡¥¨‡µã‡¥£‡µç‡¥ü‡µç",
                    "Tea": "‡¥ö‡¥æ‡¥Ø",
                    "Coffee": "‡¥ï‡¥æ‡¥™‡µç‡¥™‡¥ø",
                    "Kallummakkaya": "‡¥ï‡¥≤‡µç‡¥≤‡µÅ‡¥Æ‡µç‡¥Æ‡¥ï‡µç‡¥ï‡¥æ‡¥Ø"
                }
            },
            hi: {
                mainTitle: "üçõ ‡§ú‡•ã‡§∏‡•á‡§ü‡•ç‡§ü‡§® ‡§ï‡•Ä ‡§ö‡§æ‡§Ø ‡§ï‡•Ä ‡§¶‡•Å‡§ï‡§æ‡§® üçõ",
                mainSubtitle: "‡§ï‡•á‡§∞‡§≤ ‡§ï‡•á ‡§™‡•ç‡§∞‡§æ‡§Æ‡§æ‡§£‡§ø‡§ï ‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä‡§ü ‡§∏‡•ç‡§®‡•à‡§ï‡•ç‡§∏",
                menuTitle: "‡§π‡§Æ‡§æ‡§∞‡§æ ‡§Æ‡•á‡§®‡•Ç",
                cartTitle: "üõí ‡§Ü‡§™‡§ï‡§æ ‡§¨‡§ø‡§≤",
                totalLabel: "‡§ï‡•Å‡§≤",
                clearBtn: "‡§∏‡§¨ ‡§∏‡§æ‡§´ ‡§ï‡§∞‡•á‡§Ç",
                payBtn: "‡§¨‡§ø‡§≤ ‡§≠‡•Å‡§ó‡§§‡§æ‡§®",
                removeBtn: "‡§®‡§ø‡§ï‡§æ‡§≤‡•á‡§Ç",
                emptyCart: "‡§Ü‡§™‡§ï‡§æ ‡§ï‡§æ‡§∞‡•ç‡§ü ‡§ñ‡§æ‡§≤‡•Ä ‡§π‡•à!",
                orderPlaced: "‚úÖ ‡§ë‡§∞‡•ç‡§°‡§∞ ‡§¶‡•á ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ! ‡§ß‡§®‡•ç‡§Ø‡§µ‡§æ‡§¶ ‚Äî ‡§´‡§ø‡§∞ ‡§Ü‡§è‡§Ç",
                items: {
                    "Uzhunnu Vada": "‡§â‡§°‡§º‡§¶ ‡§µ‡§°‡§º‡§æ",
                    "Pazham Pori": "‡§ï‡•á‡§≤‡§æ ‡§¨‡§ú‡•ç‡§ú‡•Ä",
                    "Parippu Vada": "‡§¶‡§æ‡§≤ ‡§µ‡§°‡§º‡§æ",
                    "Sukhiyan": "‡§∏‡•Å‡§ñ‡§ø‡§Ø‡§®",
                    "Kappa Bajji": "‡§ï‡§™‡•ç‡§™‡§æ ‡§¨‡§ú‡•ç‡§ú‡•Ä",
                    "Egg Bonda": "‡§Ö‡§Ç‡§°‡§æ ‡§¨‡•ã‡§Ç‡§°‡§æ",
                    "Tea": "‡§ö‡§æ‡§Ø",
                    "Coffee": "‡§ï‡•â‡§´‡•Ä",
                    "Kallummakkaya": "‡§ï‡§≤‡•ç‡§≤‡•Å‡§Æ‡§ï‡•ç‡§ï‡§æ‡§Ø‡§æ"
                }
            }
        };

        function changeLanguage(lang) {
            currentLang = lang;
            const t = translations[lang];

            // Update UI static text
            document.getElementById('main-title').textContent = t.mainTitle;
            document.getElementById('main-subtitle').textContent = t.mainSubtitle;
            document.getElementById('menu-title').textContent = t.menuTitle;
            document.getElementById('cart-title').textContent = t.cartTitle;
            document.getElementById('total-label').textContent = t.totalLabel;
            document.getElementById('clear-btn').textContent = t.clearBtn;
            document.getElementById('pay-btn').textContent = t.payBtn;

            // Update Menu Item Names
            for (const itemKey in t.items) {
                const id = `name-${itemKey.replace(/ /g, '-')}`;
                const el = document.getElementById(id);
                if (el) {
                    el.textContent = t.items[itemKey];
                }
            }

            // Update Cart and confirmation if visible
            updateCart();
            if (document.getElementById("confirmation").innerHTML.includes("Order placed") ||
                document.getElementById("confirmation").innerHTML.includes("‡¥ì‡µº‡¥°‡µº ‡¥®‡µΩ‡¥ï‡¥ø") ||
                document.getElementById("confirmation").innerHTML.includes("‡§ë‡§∞‡•ç‡§°‡§∞ ‡§¶‡•á ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ")) {
                document.getElementById("confirmation").innerHTML =
                    `${t.orderPlaced} <img src='images/rich.jpg' style='width: 90px; vertical-align: middle; margin-left: 5px;'>`;
            }
        }

        // üÜï NEW: Function to open and close the floating cart popup
        function toggleCart() {
            const modal = document.getElementById('cart-modal');
            if (modal.style.display === "flex") {
                modal.style.display = "none";
            } else {
                modal.style.display = "flex";
            }
        }

        // üÜï NEW: Function to handle quantity changes from the menu
        function changeQuantity(name, price, delta) {
            if (delta === 1) {
                addToCart(name, price);
            } else if (delta === -1) {
                // Find the last index of the item with the given name
                const index = cart.map(item => item.name).lastIndexOf(name);
                if (index !== -1) {
                    removeFromCart(index);
                }
            }
        }

        // Function to add item
        function addToCart(name, price) {
            console.log('addToCart called', { name, price });

            // Validation
            if (typeof name !== 'string' || typeof price !== 'number') {
                console.error('addToCart invalid args', name, price);
                return;
            }

            // Clear "Order Placed" message if user adds new items
            document.getElementById("confirmation").innerHTML = "";

            cart.push({ name, price });
            total += price;
            updateCart();
        }

        // Function to remove a single item
        function removeFromCart(index) {
            console.log('removeFromCart called', index);
            if (index > -1 && index < cart.length) {
                total -= cart[index].price; // Subtract price
                cart.splice(index, 1);      // Remove from array
                updateCart();               // Update screen
            }
        }

        // Function to clear everything
        function clearCart() {
            console.log('clearCart called');
            if (cart.length === 0) {
                alert("Cart is already empty!");
                return;
            }
            cart = [];
            total = 0;
            document.getElementById("confirmation").innerHTML = "";
            updateCart();
        }

        // Function to update the UI
        function updateCart() {
            const list = document.getElementById("cart-items");
            const totalDisplay = document.getElementById("total");
            const badge = document.getElementById("cart-badge"); // üÜï Grab the red badge

            if (!list || !totalDisplay) {
                console.error('updateCart: missing DOM elements');
                return;
            }

            list.innerHTML = "";

            // üÜï Track counts for each item to update the menu UI
            const counts = {};

            cart.forEach((item, index) => {
                const li = document.createElement("li");

                // Update counts mapping
                counts[item.name] = (counts[item.name] || 0) + 1;

                // Item text - TRANSLATED
                const translatedName = translations[currentLang].items[item.name] || item.name;
                const span = document.createElement("span");
                span.textContent = `${translatedName} - ‚Çπ${item.price} `;

                // Remove (X) Button - TRANSLATED
                const removeBtn = document.createElement("button");
                removeBtn.textContent = translations[currentLang].removeBtn;
                removeBtn.style.marginLeft = "10px";
                removeBtn.style.padding = "2px 6px";
                removeBtn.style.fontSize = "0.8rem";
                removeBtn.style.background = "#ff5252";
                removeBtn.style.color = "white";
                removeBtn.style.border = "none";
                removeBtn.style.borderRadius = "4px";
                removeBtn.style.cursor = "pointer";
                removeBtn.onclick = () => removeFromCart(index);

                li.appendChild(span);
                li.appendChild(removeBtn);
                list.appendChild(li);
            });

            totalDisplay.textContent = total;

            // üÜï Update the red number on the floating cart icon!
            if (badge) {
                badge.textContent = cart.length;
            }

            // üÜï NEW: Update all quantity spans in the menu
            const menuItems = [
                'Uzhunnu Vada', 'Pazham Pori', 'Parippu Vada',
                'Sukhiyan', 'Kappa Bajji', 'Egg Bonda',
                'Tea', 'Coffee', 'Kallummakkaya'
            ];

            menuItems.forEach(name => {
                const id = `qty-${name.replace(/ /g, '-')}`;
                const span = document.getElementById(id);
                if (span) {
                    span.textContent = counts[name] || 0;
                }
            });
        }

        // Function to place order
        function placeOrder() {
            const t = translations[currentLang];
            console.log('placeOrder called', { cart, total });
            if (cart.length === 0) {
                alert(t.emptyCart);
                return;
            }

            // Kept your larger 90px rich.jpg image!
            document.getElementById("confirmation").innerHTML =
                `${t.orderPlaced} <img src='images/rich.jpg' style='width: 90px; vertical-align: middle; margin-left: 5px;'>`;

            cart = [];
            total = 0;
            updateCart();
        }

        // Expose functions to HTML buttons
        window.changeLanguage = changeLanguage; // üÜï Expose the translation function
        window.toggleCart = toggleCart; // üÜï Expose the toggle function
        window.changeQuantity = changeQuantity; // üÜï Expose the new function
        window.addToCart = addToCart;
        window.removeFromCart = removeFromCart;
        window.clearCart = clearCart;
        window.placeOrder = placeOrder;

        // Initialize with Malayalam
        changeLanguage('ml');
    </script>
</body>

</html>
